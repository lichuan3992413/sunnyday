package com.hskj.threads.persistence;

import java.util.List;

import javax.annotation.Resource;

import org.springframework.stereotype.Service;

import com.hskj.dao.IMessageDAO;
import com.hskj.dataCenter.DataCenter_old;
import com.hskj.thread.fremawork.ObjectWriteThread;

/**
 * 数据中心LongMessageInsertDBQueue队列中长短信分条保存到数据库submit_message_long表中
 */
@Service
public class LongMsgInsertDBThread extends ObjectWriteThread{
	private String tableName = "submit_message_long";
	@Resource(name="${db.type}_MessageDAO")
	private IMessageDAO msgDAO;
	
	public void initConfigParam(){
		this.setTimeInterval(1000);
	}
	@Override
	protected Object getOneMessage() {
		return DataCenter_old.getInsertDBLongMessage();
	}

	@Override
	protected String getGroupKey(Object smsObj) {
		return "longMessage";
	}

	@Override
	protected void writeList(List<Object> list) {
		msgDAO.insertIntoSubmitMessageLong(list, tableName);
	}

}
